#include "Globals.h"


// VARS CLASS
int mul = 10000;
double w_sn_E[10], w_cd_E[10], Ks[10], v[10];
complex<double> w_csn_E[10], w_ccd_E[10];
// SPECS
double pi = 22.0 / 7.0;
double kilo = 1000;		// kilo Multiplier
double fs = 9 * kilo;	// Sampling Rate
double pbel = 0.19*kilo;	// Lower Passband Edge
double pbeh = 4.2*kilo;	// Upper Passband Edge
double sbel = 2.5*kilo;	// Lower Stopband Edge
double sbeh = 3.3*kilo;	// Upper Stopband Edge
double ppr = 1.2;		// Peak Passband Ripple
double msba = 35;		// Minimum Stopband attenuation
double dif = 4.5*kilo;	// Digital Input Signal Frequency
						// RADIAN VALUES OF EDGE FREQUENCIES
double Omp1 = (2.0 * pbel) / fs;
double Omp2 = (2.0 * pbeh) / fs;
double Oms1 = (2.0 * sbel) / fs;
double Oms2 = (2.0 * sbeh) / fs;
double OMp1 = tan((pi*Omp1) / 2);
double OMp2 = tan((pi*Omp2) / 2);
double OMs1 = tan((pi*Oms1) / 2);
double OMs2 = tan((pi*Oms2) / 2);
// BANDWIDTH
double Bwp = OMp2 - OMp1;
double Omp0Q = OMp2 * OMp1;
double Bws = OMs2 - OMs1;
double Oms0Q = OMs2 * OMs1;
// MODIFIED VALUES
double Os = 1;
double Op1m = Oms0Q / OMp2;
double Op1mQ = Op1m*Op1m;
double Op = (Op1m*Bws) / (Oms0Q - Op1mQ);
double Oc = sqrt(Op*Os);
double OT = (Os/Op);
double N = 2; //from hand calculations
// SIGMAS
double Sigp = 1 - (pow(10, (-(ppr / 20))));
double Sigs = (pow(10, (-(msba / 20))));
// INPUT
double datArr[] = { 0.721231742083420,-1.02364247105703,2.95876022320659,1.44451430255329,0.507554251924161,-4.76689854391235e-13,-0.507554251928032,-1.44451430254709,-2.95876022321167,1.02364247105359,-0.721231742082521,-0.685166352859856,-2.60152016185505,-0.434783461974844,-2.08821101166639,-1.53884176859313,1.27138066748195,1.03702265314320,0.427569112931993,-1.84005216917163,1.14203952191950,-1.30677994422785,0.0527175746462815,0.294919350993042,1.40210154969844,-1.53884176858853,-3.08018125018288,-1.08901584151996,-2.55104113175195,-1.39252872686528,-2.00000000000128,0.572045774592065,-3.28729023711934,-2.77767169253143,-1.71108703832754,-0.363271264003179,-0.407552555225341,-0.202460423343108,2.04877103151494,-1.55744641135447,-0.760073510671345,-0.876544820970272,1.96859559847694,-0.504003832400157,0.307873319269456,0.363271263998636,-1.83754454453970,-2.43083691882483,-2.10414038752962,1.12448775207560,-1.89680224666823,-0.345451740801075,-1.27010437220926,-0.708265197174180,-2.47212875337891,-6.41971670808996e-13,2.47212875338388,0.708265197176426,1.27010437221242,0.345451740799202,1.89680224666863,-1.12448775207016,2.10414038751972,2.43083691882922,1.83754454453624,-0.363271264000924,-0.307873319270192,0.504003832407299,-1.96859559848000,0.876544820966460,0.760073510669987,1.55744641135951,-2.04877103150541,0.202460423334048,0.407552555231629,0.363271263999119,1.71108703832786,2.77767169251836,3.28729023712915,-0.572045774592634,1.99999999999705,1.39252872686611,2.55104113175601,1.08901584152221,3.08018125017593,1.53884176858688,-1.40210154970354,-0.294919350992745,-0.0527175746563516,1.30677994423121,-1.14203952192076,1.84005216916795,-0.427569112923534,-1.03702265314532,-1.27138066748064,1.53884176858559,2.08821101167368,0.434783461963765,2.60152016185264,0.685166352858834,0.721231742086136,-1.02364247105922,2.95876022320727,1.44451430254635,0.507554251919727,-2.27216108754837e-12,-0.507554251924723,-1.44451430254157,-2.95876022321428,1.02364247105579,-0.721231742082856,-0.685166352856251,-2.60152016185393,-0.434783461971386,-2.08821101166971,-1.53884176859850,1.27138066747727,1.03702265314051,0.427569112933072,-1.84005216917065,1.14203952191961,-1.30677994422806,0.0527175746495179,0.294919350995894,1.40210154969902,-1.53884176859396,-3.08018125018568,-1.08901584152364,-2.55104113175475,-1.39252872686379,-2.00000000000098,0.572045774591784,-3.28729023712310,-2.77767169252761,-1.71108703832384,-0.363271264007791,-0.407552555223088,-0.202460423339113,2.04877103151175,-1.55744641135500,-0.760073510671264,-0.876544820968392,1.96859559848001,-0.504003832403742,0.307873319267748,0.363271264002013,-1.83754454453987,-2.43083691882266,-2.10414038752603,1.12448775207306,-1.89680224666555,-0.345451740803748,-1.27010437220572,-0.708265197174464,-2.47212875338338,-7.89832008067079e-12,2.47212875338576,0.708265197170256,1.27010437220946,0.345451740798808,1.89680224666836,-1.12448775207244,2.10414038752293,2.43083691883196,1.83754454454088,-0.363271263995887,-0.307873319272969,0.504003832409489,-1.96859559848147,0.876544820966092,0.760073510670002,1.55744641135912,-2.04877103150855,0.202460423331740,0.407552555233883,0.363271264001783,1.71108703832464,2.77767169252184,3.28729023712994,-0.572045774592915,1.99999999999736,1.39252872686521,2.55104113175319,1.08901584152534,3.08018125017377,1.53884176859625,-1.40210154969977,-0.294919350996147,-0.0527175746531698,1.30677994423114,-1.14203952192065,1.84005216916892,-0.427569112926998,-1.03702265314220,-1.27138066747840,1.53884176858023,2.08821101167037,0.434783461967223,2.60152016185376,0.685166352860050,0.721231742085801,-1.02364247105702,2.95876022320298,1.44451430255207,0.507554251922468,8.43791982867226e-12,-0.507554251928219,-1.44451430254851,-2.95876022321100,1.02364247105347,-0.721231742083083,-0.685166352859569,-2.60152016185656,-0.434783461974540,-2.08821101166803,-1.53884176859162,1.27138066748093,1.03702265314025,0.427569112933694,-1.84005216917045,1.14203952191972,-1.30677994422452,0.0527175746467478,0.294919350993276,1.40210154970232,-1.53884176857777,-3.08018125018199,-1.08901584152090,-2.55104113175610,-1.39252872686362,-2.00000000000067,0.572045774592561,-3.28729023712085,-2.77767169253041,-1.71108703832815,-0.363271264002817,-0.407552555226685,-0.202460423341227,2.04877103151283,-1.55744641135456,-0.760073510671115,-0.876544820970377,1.96859559847727,-0.504003832401274,0.307873319271026,0.363271264015839,-1.83754454453664,-2.43083691882609,-2.10414038752656,1.12448775207468,-1.89680224666571,-0.345451740800089,-1.27010437220938,-0.708265197173983,-2.47212875338056,1.21623614138013e-12,2.47212875338876,0.708265197177073,1.27010437221041,0.345451740800219,1.89680224666809,-1.12448775207082,2.10414038752068,2.43083691882863,1.83754454453719,-0.363271263992577,-0.307873319269691,0.504003832414561,-1.96859559847828,0.876544820966428,0.760073510670150,1.55744641135950,-2.04877103150574,0.202460423334950,0.407552555230327,0.363271263999936,1.71108703832682,2.77767169251959,3.28729023712644,-0.572045774592130,1.99999999999766,1.39252872686538,2.55104113175156,1.08901584152222,3.08018125017789,1.53884176859991,-1.40210154970568,-0.294919350992879,-0.0527175746542101,1.30677994423015,-1.14203952192061,1.84005216916912,-0.427569112924646,-1.03702265314506,-1.27138066748114,1.53884176858326,2.08821101167205,0.434783461965099,2.60152016185531,0.685166352859086,0.721231742085574,-1.02364247105935,2.95876022320637,1.44451430254502,0.507554251919653,2.20866192437210e-12,-0.507554251927236,-1.44451430254280,-2.95876022321151,1.02364247105780,-0.721231742083310,-0.685166352856104,-2.60152016185371,-0.434783461970613,-2.08821101166495,-1.53884176859699,1.27138066747668,1.03702265314096,0.427569112930307,-1.84005216917505,1.14203952191983,-1.30677994422918,0.0527175746499297,0.294919350992139,1.40210154969917,-1.53884176857366,-3.08018125018530,-1.08901584152366,-2.55104113175492,-1.39252872686452,-2.00000000000037,0.572045774592280,-3.28729023712407,-2.77767169252694,-1.71108703832493,-0.363271264006974,-0.407552555224864,-0.202460423337600,2.04877103150968,-1.55744641135649,-0.760073510671033,-0.876544820968497,1.96859559848000,-0.504003832399084,0.307873319268249,0.363271264010361,-1.83754454454082,-2.43083691882335,-2.10414038752497,1.12448775207239,-1.89680224666609,-0.345451740802620,-1.27010437220805,-0.708265197174379,-2.47212875337650,-6.49485961936812e-12,2.47212875338465,0.708265197170903,1.27010437221140,0.345451740796075,1.89680224666782,-1.12448775207325,2.10414038751999,2.43083691883080,1.83754454454033,-0.363271263996568,-0.307873319280005,0.504003832408455,-1.96859559848121,0.876544820965188,0.760073510670232,1.55744641135896,-2.04877103150888,0.202460423333058,0.407552555233218,0.363271264002600,1.71108703832401,2.77767169252307,3.28729023712869,-0.572045774593883,1.99999999999797,1.39252872686463,2.55104113175302,1.08901584152442,3.08018125017466,1.53884176859444,-1.40210154970926,-0.294919350993842,-0.0527175746527584,1.30677994423141,-1.14203952192051,1.84005216917003,-0.427569112927766,-1.03702265314175,-1.27138066747782,1.53884176858174,2.08821101166820,0.434783461962736,2.60152016185388,0.685166352858972,0.721231742085347,-1.02364247105726,2.95876022320375,1.44451430255054,0.507554251922963,7.80283514312001e-12,-0.507554251930300,-1.44451430253147,-2.95876022321607,1.02364247105484,-0.721231742083537,-0.685166352859176,-2.60152016185670,-0.434783461973205,-2.08821101166870,-1.53884176859065,1.27138066748043,1.03702265314107,0.427569112932927,-1.84005216917096,1.14203952191987,-1.30677994422572,0.0527175746474267,0.294919350998515,1.40210154970207,-1.53884176857569,-3.08018125018807,-1.08901584151769,-2.55104113175600,-1.39252872686288,-2.00000000000006,0.572045774592924,-3.28729023712183,-2.77767169252881,-1.71108703832122,-0.363271264002036,-0.407552555229530,-0.202460423339395,2.04877103151222,-1.55744641135830,-0.760073510670951,-0.876544820970269,1.96859559847726,-0.504003832402871,0.307873319272047,0.363271264012976,-1.83754454453769,-2.43083691882147,-2.10414038752560,1.12448775207535,-1.89680224666625,-0.345451740799071,-1.27010437220939,-0.708265197173704,-2.47212875337992,3.18813079129088e-12,2.47212875338721,0.708265197177465,1.27010437220834,0.345451740799875,1.89680224667050,-1.12448775207163,2.10414038752174,2.43083691882774,1.83754454453664,-0.363271263995531,-0.307873319282870,0.504003832412687,-1.96859559847821,0.876544820967935,0.760073510670381,1.55744641136217,-2.04877103150634,0.202460423336831,0.407552555230053,0.363271264000298,1.71108703832619,2.77767169252117,3.28729023712548,-0.572045774593247,1.99999999999827,1.39252872686465,2.55104113175167,1.08901584152128,3.08018125017249,1.53884176859674,-1.40210154970597,-0.294919350991309,-0.0527175746534764,1.30677994423036,-1.14203952192040,1.84005216917009,-0.427569112925414,-1.03702265314416,-1.27138066748109,1.53884176857931,2.08821101167031,0.434783461966334,2.60152016185527,0.685166352858639,0.721231742085120,-1.02364247105944,2.95876022320703,1.44451430254912,0.507554251920968,-2.45412164726010e-13,-0.507554251926353,-1.44451430253852,-2.95876022322172,1.02364247105915,-0.721231742080820,-0.685166352857960,-2.60152016185359,-0.434783461969747,-2.08821101166552,-1.53884176859375,1.27138066747575,1.03702265314178,0.427569112929462,-1.84005216917387,1.14203952191997,-1.30677994423038,0.0527175746503960,0.294919350991811,1.40210154969999,-1.53884176857728,-3.08018125018335,-1.08901584151651,-2.55104113175715,-1.39252872686364,-1.99999999999975,0.572045774592783,-3.28729023712531,-2.77767169252536,-1.71108703832553,-0.363271264004828,-0.407552555226166,-0.202460423335768,2.04877103151503,-1.55744641135659,-0.760073510670869,-0.876544820968529,1.96859559848033,-0.504003832400681,0.307873319269906,0.363271264007861,-1.83754454454030,-2.43083691881888,-2.10414038753712,1.12448775207542,-1.89680224666651,-0.345451740801743,-1.27010437220806,-0.708265197173620,-2.47212875337804,-2.70397556591152e-12,2.47212875338411,0.708265197171294,1.27010437221101,0.345451740797202,1.89680224667034,-1.12448775207403,2.10414038751596,2.43083691882954,1.83754454453427,-0.363271263999431,-0.307873319278435,0.504003832417758,-1.96859559848445,0.876544820965083,0.760073510670463,1.55744641135900,-2.04877103150927,0.202460423331193,0.407552555231874,0.363271263997925,1.71108703832297,2.77767169252287,3.28729023712772,-0.572045774593387,1.99999999999858,1.39252872686390,2.55104113175287,1.08901584152385,3.08018125017615,1.53884176859085,-1.40210154970805,-0.294919350993927,-0.0527175746579375,1.30677994423029,-1.14203952192029,1.84005216916896,-0.427569112928878,-1.03702265314085,-1.27138066747841,1.53884176858452,2.08821101166657,0.434783461963971,2.60152016185411,0.685166352859118,0.721231742084785,-1.02364247105753,2.95876022320469,1.44451430254876,0.507554251923959,5.68982156718675e-12,-0.507554251929304,-1.44451430253281,-2.95876022321844,1.02364247105472,-0.721231742081155,-0.685166352859029,-2.60152016185416,-0.434783461971970,-2.08821101167077,-1.53884176858732,1.27138066747984,1.03702265314197,0.427569112931814,-1.84005216916978,1.14203952192008,-1.30677994422536,0.0527175746478932,0.294919350997819,1.40210154970328,-1.53884176857022,-3.08018125018658,-1.08901584151769,-2.55104113175851,-1.39252872686265,-1.99999999999945,0.572045774593420,-3.28729023712280,-2.77767169252760,-1.71108703832183,-0.363271263999400,-0.407552555223275,-0.202460423337882,2.04877103151183,-1.55744641135826,-0.760073510670788,-0.876544820968829,1.96859559847732,-0.504003832404183,0.307873319266784,0.363271264011840,-1.83754454453683,-2.43083691882207,-2.10414038753390,1.12448775207560,-1.89680224666667,-0.345451740803094,-1.27010437220539,-0.708265197172944,-2.47212875338115,-7.51690120322413e-13,2.47212875338706,0.708265197178112,1.27010437220833,0.345451740800752,1.89680224667007,-1.12448775207107,2.10414038751944,2.43083691882658,1.83754454454208,-0.363271263996120,-0.307873319281212,0.504003832411569,-1.96859559848315,0.876544820960968,0.760073510670544,1.55744641136060,-2.04877103150673,0.202460423338663,0.407552555228318,0.363271264003533,1.71108703832665,2.77767169252240,3.28729023712423,-0.572045774592986,1.99999999999889,1.39252872686553,2.55104113175150,1.08901584152035,3.08018125017442,1.53884176859497,-1.40210154970519,-0.294919350991075,-0.0527175746586557,1.30677994423467,-1.14203952192018,1.84005216916979,-0.427569112926259,-1.03702265314371,-1.27138066748158,1.53884176858073,2.08821101166931,0.434783461967201,2.60152016185539,0.685166352859032,0.721231742084558,-1.02364247105810,2.95876022320781,1.44451430255089,0.507554251921964,6.28177392618355e-12,-0.507554251925994,-1.44451430253974,-2.95876022321933,1.02364247105356,-0.721231742081274,-0.685166352859144,-2.60152016185715,-0.434783461968412,-2.08821101166505,-1.53884176859269,1.27138066748316,1.03702265314268,0.427569112928694,-1.84005216917291,1.14203952192019,-1.30677994423016,0.0527175746510747,0.294919350991115,1.40210154970077,-1.53884176857860,-3.08018125018292,-1.08901584151743,-2.55104113175532,-1.39252872686409,-1.99999999999914,0.572045774591667,-3.28729023712200,-2.77767169252376,-1.71108703832657,-0.363271264004011,-0.407552555226440,-0.202460423334255,2.04877103151437,-1.55744641135654,-0.760073510670639,-0.876544820967022,1.96859559847631,-0.504003832402360,0.307873319271909,0.363271264006817,-1.83754454454095,-2.43083691881967,-2.10414038753443,1.12448775207462,-1.89680224666411,-0.345451740802087,-1.27010437220819,-0.708265197175651,-2.47212875337927,-8.45767753722393e-13,2.47212875338363,0.708265197171941,1.27010437221100,0.345451740798220,1.89680224666980,-1.12448775207336,2.10414038751865,2.43083691882875,1.83754454453840,-0.363271264000566,-0.307873319279188,0.504003832416079,-1.96859559848034,0.876544820966036,0.760073510668244,1.55744641135752,-2.04877103150988,0.202460423333026,0.407552555230572,0.363271263998287,1.71108703832341,2.77767169251802,3.28729023712674,-0.572045774593024,1.99999999999919,1.39252872686625,2.55104113175470,1.08901584152292,3.08018125017767,1.53884176859677,-1.40210154970723,-0.294919350994623,-0.0527175746554740,1.30677994423368,-1.14203952192114,1.84005216916845,-0.427569112925559,-1.03702265314592,-1.27138066747934,1.53884176858604,2.08821101167282,0.434783461964744,2.60152016185396,0.685166352859512,0.721231742084332,-1.02364247105763,2.95876022320719,1.44451430254686,0.507554251925274,3.69049482897510e-12,-0.507554251928422,-1.44451430253422,-2.95876022321605,1.02364247105551,-0.721231742078558,-0.685166352860108,-2.60152016185577,-0.434783461971004,-2.08821101166889,-1.53884176858590,1.27138066747529,1.03702265314185,0.427569112933365,-1.84005216916868,1.14203952192023,-1.30677994422662,0.0527175746500346,0.294919350997539,1.40210154970406,-1.53884176857199,-3.08018125018462,-1.08901584151863,-2.55104113175694,-1.39252872686177,-2.00000000000248,0.572045774592451,-3.28729023712577,-2.77767169252601,-1.71108703832246,-0.363271263999038,-0.407552555224619,-0.202460423336612,2.04877103151150,-1.55744641135841,-0.760073510670557,-0.876544820966686,1.96859559847931,-0.504003832405779,0.307873319269769,0.363271264011251,-1.83754454453631,-2.43083691882333,-2.10414038753084,1.12448775207616,-1.89680224666438,-0.345451740802108,-1.27010437220724,-0.708265197172297,-2.47212875338269,-4.91888470737894e-12,2.47212875338595,0.708265197172423,1.27010437220794,0.345451740801879,1.89680224666953,-1.12448775207174,2.10414038752224,2.43083691882532,1.83754454454304,-0.363271263997256,-0.307873319282743,0.504003832410341,-1.96859559848316,0.876544820962407,0.760073510668393,1.55744641135961,-2.04877103150880,0.202460423334289,0.407552555226975,0.363271264004350,1.71108703832559,2.77767169252344,3.28729023712326,-0.572045774592490,1.99999999999950,1.39252872686481,2.55104113175308,1.08901584152410,3.08018125017594,1.53884176859316,-1.40210154970393,-0.294919350991723,-0.0527175746582441,1.30677994423509,-1.14203952192109,1.84005216916686,-0.427569112929024,-1.03702265314281,-1.27138066747666,1.53884176858179,2.08821101166758,0.434783461967973,2.60152016185561,0.685166352859179,0.721231742084105,-1.02364247105833,2.95876022321047,1.44451430254956,0.507554251922846,6.10143659151776e-12,-0.507554251925112,-1.44451430253834,-2.95876022321839,1.02364247105479,-0.721231742078785,-0.685166352857560,-2.60152016185876,-0.434783461967177,-2.08821101166722,-1.53884176859127,1.27138066747947,1.03702265314256,0.427569112933988,-1.84005216917181,1.14203952191921,-1.30677994422897,0.0527175746532164,0.294919350991029,1.40210154970202,-1.53884176858041,-3.08018125018832,-1.08901584151801,-2.55104113175548,-1.39252872686334,-2.00000000000217,0.572045774593933,-3.28729023712472,-2.77767169252253,-1.71108703832720,-0.363271264003230,-0.407552555228174,-0.202460423338872,2.04877103151231,-1.55744641135656,-0.760073510670476,-0.876544820967054,1.96859559847630,-0.504003832403027,0.307873319273567,0.363271264005681,-1.83754454453859,-2.43083691882092,-2.10414038753337,1.12448775207542,-1.89680224666464,-0.345451740803418,-1.27010437221019,-0.708265197175566,-2.47212875338038,6.71379545301887e-13,2.47212875338241,0.708265197175602,1.27010437220915,0.345451740799207,1.89680224666937,-1.12448775207428,2.10414038751998,2.43083691882805,1.83754454453882,-0.363271264001155,-0.307873319284538,0.504003832414482,-1.96859559848008,0.876544820967403,0.760073510668474,1.55744641136268,-2.04877103151200,0.202460423334344,0.407552555228796,0.363271263999069,1.71108703832281,2.77767169251960,3.28729023712378,-0.572045774592528,1.99999999999980,1.39252872686566,2.55104113175026,1.08901584152254,3.08018125017960,1.53884176860022,-1.40210154970644,-0.294919350994903,-0.0527175746550623,1.30677994423624,-1.14203952192099,1.84005216916692,-0.427569112914409,-1.03702265313978,-1.27138066747993,1.53884176858415,2.08821101167075,0.434783461965610,2.60152016185614,0.685166352859799};
vector<double> Origin(datArr, datArr + sizeof datArr / sizeof datArr[0]);
// TRANSFER FUNCTIONS Z-DOMAIN
vector<double> magT(Sps), phaT(Sps), phaT_nowrap(Sps), TF(Sps);
double num[5] = { 0.117, 0.208, 0.312, 0.208, 0.117 };
double den[5] = { 1.0, 0.49,-0.811,-0.028,0.43 };
complex<double> numC, denC, T, Z;
// TRANSFER FUNCTIONS S - DOMAIN
vector<double> magTs(Sps), phaTs(Sps), phaTs_nowrap(Sps), TFs(Sps);
double nums[5] = { 0.1173,  0.0, 0.097,  0.0,  0.016 };
double dens[5] = {  0.129, 0.39, 1.208, 0.147, 0.018 };
complex<double> numsC, densC, Ts, S;
// DIRECT VARS
vector<double> axX(Origin.size()), axY(Origin.size()), pointN(Origin.size());
// CANON VARS
vector<double> X1st(Origin.size()),X2nd(Origin.size()),X3rd(Origin.size()),X4th(Origin.size()),canY(Origin.size());
double gCAN = 0.117;
double bCAN1[] = {  1.24, -0.55 };
double fCAN1[] = {  1.26,     1 };
double bCAN2[] = { -1.73, -0.79 };
double fCAN2[] = {  0.47,     1 };
// FIND THE ORDER OF THE FILTER NEEDED (FREQUENCIES ALREADY PREWARPED)
double Fp1 = 2 * atan(Omp1) / pi;
double Fp2 = 2 * atan(Omp2) / pi;
double Fs1 = 2 * atan(Oms1) / pi;
double Fs2 = 2 * atan(Oms2) / pi;
double c = sin(pi*(Fp1 + Fp2)) / (sin(pi*Fp1) + sin(pi*Fp2));
double wpa = abs(sin(pi*Fp2) / (cos(pi*Fp2) - c));
double ws1 = sin(pi*Fs1) / (cos(pi*Fs1) - c);
double ws2 = sin(pi*Fs2) / (cos(pi*Fs2) - c);
double wsa = std::min(abs(ws1), abs(ws2));
double WA = wsa / wpa;
double epsilon = sqrt(pow(10, (0.1*ppr)) - 1);
double k1 = epsilon / sqrt(pow(10, (0.1*msba)) - 1);
double k = 1 / WA;
double ellipK1 = pow(k, 2);
double ellipK2 = 1 - ellipK1; //
double ellipK11 = pow(k1, 2);
double ellipK12 = 1 - ellipK11; // 
double capk1, capk2, capk11, capk12, OO, wn1, wn2, kret, e;
// DFT FFT VAR
int FFTsize = floor(double(Origin.size()) / 2.0);
vector<double> FFT_O(Origin.size()), FFT_D(Origin.size()), FFT_C(Origin.size()), FFTaxX(FFTsize);
double FFT_O_r,FFT_O_i,FFT_D_r,FFT_D_i,FFT_C_r,FFT_C_i;

complex<double> z_ap[10];
complex<double> p_ap[10];
double k_ap;
//  output of state space
//  [a,b,c,d]
